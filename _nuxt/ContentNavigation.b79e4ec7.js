import{c as f,w as l,e as d,s as v,j as w,u as P,a as C}from"./utils.74d1f658.js";import{Q as m,V as T,W as E,X as j,M as _,g as L,Y as N,h as Q,Z as b,R as x,U as u,e as D}from"./entry.a6c8cc0b.js";import{h as p,u as y}from"./preview.cf3e4dac.js";const g=()=>async a=>{const{content:n}=m().public,e=a.params(),s=n.experimental.stripQueryParameters?l(`/query/${`${p(e)}.${n.integrity}`}/${d(e)}.json`):l(`/query/${p(e)}.${n.integrity}.json`);if(v())return(await _(()=>import("./client-db.0fba5ebc.js"),["./client-db.0fba5ebc.js","./navigation.0386e11b.js","./entry.a6c8cc0b.js","./entry.0501af88.css","./utils.74d1f658.js","./preview.cf3e4dac.js","./index.a6ef77ff.js"],import.meta.url).then(t=>t.useContentDatabase())).fetch(a);const r=await $fetch(s,{method:"GET",responseType:"json",params:n.experimental.stripQueryParameters?void 0:{_params:w(e),previewToken:y().getPreviewToken()}});if(typeof r=="string"&&r.startsWith("<!DOCTYPE html>"))throw new Error("Not found");return r};function R(a,...n){const{content:e}=m().public,s=e.experimental.advanceQuery?f(g(),{initialParams:typeof a!="string"?a:{},legacy:!1}):f(g(),{initialParams:typeof a!="string"?a:{},legacy:!0});let r;typeof a=="string"&&(r=T(E(a,...n)));const c=s.params;return s.params=()=>{var i,o,h;const t=c();return r&&(t.where=t.where||[],t.first&&(t.where||[]).length===0?t.where.push({_path:j(r)}):t.where.push({_path:new RegExp(`^${r.replace(/[-[\]{}()*+.,^$\s/]/g,"\\$&")}`)})),(i=t.sort)!=null&&i.length||(t.sort=[{_file:1,$numeric:!0}]),e.locales.length&&((h=(o=t.where)==null?void 0:o.find($=>$._locale))!=null&&h._locale||(t.where=t.where||[],t.where.push({_locale:e.defaultLocale}))),t},s}const O=async a=>{const{content:n}=m().public;typeof(a==null?void 0:a.params)!="function"&&(a=R(a));const e=a.params(),s=n.experimental.stripQueryParameters?l(`/navigation/${`${p(e)}.${n.integrity}`}/${d(e)}.json`):l(`/navigation/${p(e)}.${n.integrity}.json`);if(v())return(await _(()=>import("./client-db.0fba5ebc.js"),["./client-db.0fba5ebc.js","./navigation.0386e11b.js","./entry.a6c8cc0b.js","./entry.0501af88.css","./utils.74d1f658.js","./preview.cf3e4dac.js","./index.a6ef77ff.js"],import.meta.url).then(t=>t.generateNavigation))(e);const r=await $fetch(s,{method:"GET",responseType:"json",params:n.experimental.stripQueryParameters?void 0:{_params:w(e),previewToken:y().getPreviewToken()}});if(typeof r=="string"&&r.startsWith("<!DOCTYPE html>"))throw new Error("Not found");return r},S=L({name:"ContentNavigation",props:{query:{type:Object,required:!1,default:void 0}},async setup(a){const{query:n}=N(a),e=Q(()=>{var r;return typeof((r=n.value)==null?void 0:r.params)=="function"?n.value.params():n.value});if(!e.value&&b("dd-navigation").value){const{navigation:r}=P();return{navigation:r}}const{data:s}=await C(`content-navigation-${p(e.value)}`,()=>O(e.value));return{navigation:s}},render(a){const n=x(),{navigation:e}=a,s=t=>u(D,{to:t._path},()=>t.title),r=(t,i)=>u("ul",i?{"data-level":i}:null,t.map(o=>o.children?u("li",null,[s(o),r(o.children,i+1)]):u("li",null,s(o)))),c=t=>r(t,0);return n!=null&&n.default?n.default({navigation:e,...this.$attrs}):c(e)}}),Y=S;export{Y as default};
